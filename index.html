<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collage Fodder</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/interactjs/dist/interact.min.js"></script>
    <script src="overlays.js"></script>
</head>
<body>
    <!-- Alert Container -->
    <div id="alert-container" style="position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 1050; max-width: 400px;"></div>
    
    <div class="app-container">
        <!-- Left Toolbar -->
        <aside class="left-toolbar">
            <div class="toolbar-buttons">
                <a href="index.html" class="toolbar-favicon" title="Home">
                    <img src="favicon.png" alt="Home" />
                </a>
                <button id="tryAgainBtn" class="toolbar-btn" title="Try Again">
                    <i class="bi bi-arrow-repeat"></i>
                </button>
                <button id="filterBtn" class="toolbar-btn" title="Filter Tags">
                    <i class="bi bi-funnel"></i>
                </button>
                <div id="tag-filters" class="dropdown-menu dropdown-menu-dark filter-dropdown">
                    <!-- Tag filter buttons will be generated here -->
                </div>
                <button id="layoutBtn" class="toolbar-btn" title="Select Layout">
                    <i class="bi bi-columns-gap"></i>
                </button>
                <div id="layout-panel" class="layout-panel">
                    <div class="layout-panel-content">
                        <h4>Select Layout</h4>
                        <button id="clearLayoutBtn" class="btn btn-secondary btn-sm mb-3" style="width: 100%;">Clear Selection</button>
                        <div id="layout-list" class="layout-list">
                            <!-- Layouts will be populated by JavaScript -->
                        </div>
                    </div>
                </div>
                <button id="effectsBtn" class="toolbar-btn" title="SVG Effects">
                    <i class="bi bi-stars"></i>
                </button>
                <div id="blend-modes" class="dropdown-menu dropdown-menu-dark filter-dropdown effects-dropdown">
                    <!-- SVG effect buttons will be generated here -->
                </div>
                <button id="imageBtn" class="toolbar-btn" title="Add Image URL">
                    <i class="bi bi-image"></i>
                </button>
                <div id="image-modal" class="image-modal">
                    <div class="image-modal-content">
                        <h4>Add Image URL</h4>
                        <input type="text" id="imageUrlInput" class="form-control" placeholder="Enter image URL...">
                        <div class="image-modal-buttons">
                            <button id="applyImageBtn" class="btn btn-primary btn-sm">Apply</button>
                            <button id="clearImageBtn" class="btn btn-secondary btn-sm">Clear</button>
                        </div>
                    </div>
                </div>
                <button id="overlayBtn" class="toolbar-btn" title="Overlay & Texture">
                    <i class="bi bi-layers"></i>
                </button>
                <div id="overlay-panel" class="overlay-panel">
                    <div class="overlay-panel-content">
                        <h4>Overlay & Texture</h4>
                        <div id="overlay-list" class="overlay-list">
                            <!-- Overlays will be populated by JavaScript -->
                        </div>
                        <div class="overlay-controls">
                            <h5>Overlay Opacity</h5>
                            <input type="range" id="overlayOpacity" class="form-range" min="0" max="100" value="100">
                            <span id="opacityValue">100%</span>
                        </div>
                    </div>
                </div>
                <button id="paintBtn" class="toolbar-btn" title="Color Overlay">
                    <i class="bi bi-paint-bucket"></i>
                </button>
                <div id="paint-panel" class="paint-panel">
                    <div class="paint-panel-content">
                        <h4>Color Overlay</h4>
                        <div class="form-check form-switch">
                            <input class="form-check-input" type="checkbox" id="paintToggle">
                            <label class="form-check-label" for="paintToggle">
                                Enable Paint
                            </label>
                        </div>
                        <div class="control-group">
                            <label for="paintColor">Paint Color</label>
                            <div class="color-picker-wrapper">
                                <input type="color" id="paintColor" class="form-control form-control-color" value="#FFFF00">
                                <span class="color-value" id="paintColorValue">#FFFF00</span>
                            </div>
                        </div>
                        <div class="control-group">
                            <h5>Paint Opacity</h5>
                            <input type="range" id="paintOpacity" class="form-range" min="0" max="100" value="50">
                            <span id="paintOpacityValue">50%</span>
                        </div>
                    </div>
                </div>
                <button id="textBtn" class="toolbar-btn" title="Add Text">
                    <i class="bi bi-type"></i>
                </button>
                <div id="text-modal" class="text-modal">
                    <div class="text-modal-content">
                        <h4>Add Text</h4>
                        <textarea id="textInput" class="form-control" placeholder="Enter text..." rows="3"></textarea>
                        
                        <div class="font-controls">
                            <h5>Font Settings</h5>
                            
                            <div class="control-group">
                                <label for="fontFamily">Font Family</label>
                                <select id="fontFamily" class="form-control form-control-sm">
                                    <option value="Arial, sans-serif">Arial</option>
                                    <option value="'Roboto', sans-serif">Roboto</option>
                                    <option value="'Lora', serif">Lora</option>
                                    <option value="'Montserrat', sans-serif">Montserrat</option>
                                    <option value="Georgia, serif">Georgia</option>
                                    <option value="'Times New Roman', serif">Times New Roman</option>
                                </select>
                            </div>
                            
                            <div class="control-group">
                                <label for="fontSize">Font Size</label>
                                <input type="number" id="fontSize" class="form-control form-control-sm" value="24" min="8" max="120" step="1">
                            </div>
                            
                            <div class="control-group">
                                <label for="fontColor">Font Color</label>
                                <div class="color-picker-wrapper">
                                    <input type="color" id="fontColor" class="form-control form-control-color" value="#212529">
                                    <span class="color-value" id="colorValue">#212529</span>
                                </div>
                            </div>
                            
                            <div class="control-group">
                                <label>Font Style</label>
                                <div class="style-buttons">
                                    <button type="button" id="fontBold" class="btn btn-outline-secondary btn-sm" title="Bold">
                                        <strong>B</strong>
                                    </button>
                                    <button type="button" id="fontItalic" class="btn btn-outline-secondary btn-sm" title="Italic">
                                        <em>I</em>
                                    </button>
                                    <button type="button" id="fontUnderline" class="btn btn-outline-secondary btn-sm" title="Underline">
                                        <u>U</u>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="control-group">
                            <label>Text Depth</label>
                            <div class="style-buttons">
                                <button type="button" id="textBringForward" class="btn btn-outline-secondary btn-sm" title="Bring Forward">
                                    <i class="bi bi-arrow-up"></i>
                                </button>
                                <button type="button" id="textSendBackward" class="btn btn-outline-secondary btn-sm" title="Send Backward">
                                    <i class="bi bi-arrow-down"></i>
                                </button>
                            </div>
                        </div>
                        
                        <div class="text-modal-buttons">
                            <button id="clearTextBtn" class="btn btn-secondary btn-sm">Clear</button>
                        </div>
                    </div>
                </div>
                <button id="printBtn" class="toolbar-btn" title="Print/Download as PDF">
                    <i class="bi bi-printer"></i>
                </button>
                <button id="downloadJpgBtn" class="toolbar-btn" title="Download as JPG">
                    <i class="bi bi-download"></i>
                </button>
                <button id="savesBtn" class="toolbar-btn" title="Saved Collages">
                    <i class="bi bi-folder"></i>
                </button>
                <div id="saves-panel" class="saves-panel">
                    <div class="saves-panel-content">
                        <h4>Saved Collages</h4>
                        <div id="saves-list" class="saves-list">
                            <!-- Saved collages will be populated here -->
                        </div>
                        <div class="saves-controls">
                            <button id="exportSavesBtn" class="btn btn-primary btn-sm w-100 mb-2" title="Export all saves as JSON">
                                <i class="bi bi-download"></i> Export
                            </button>
                            <button id="importSavesBtn" class="btn btn-secondary btn-sm w-100" title="Import saves from JSON">
                                <i class="bi bi-upload"></i> Import
                            </button>
                            <input type="file" id="importsavesFile" accept=".json" style="display: none;">
                        </div>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Save Collage Modal -->
        <div id="save-modal" class="modal fade" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Save Collage</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="mb-3">
                            <label for="collageNameInput" class="form-label">Collage Name</label>
                            <input type="text" class="form-control" id="collageNameInput" placeholder="Enter a name for this collage...">
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="button" class="btn btn-primary" id="confirmSaveBtn">Save</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content d-flex flex-column">
            <header class="py-1 text-center">
                <h1 class="mb-0"><a href="index.html" style="text-decoration: none; color: inherit;">Collage Fodder</a></h1>
            </header>

            <div id="content-area" style="flex: 1; display: flex; align-items: center; justify-content: center; width: 100%;">
                <div id="letter-page" class="letter-page">
                    <div id="collage-container" class="collage-container">
                        <!-- Grid will be populated by JavaScript -->
                    </div>
                    <div id="text-overlay" class="text-overlay" style="display: none;">
                        <span id="text-content"></span>
                    </div>
                    <div id="generate-overlay" class="generate-overlay">
                        <button id="generateBtn" class="btn btn-primary btn-lg">Generate Fodder</button>
                    </div>
                </div>
                <button id="saveHeartBtn" class="save-heart-btn" title="Save Collage">
                    <i class="bi bi-heart"></i>
                </button>
                <button id="shareBtn" class="share-btn" title="Share Collage">
                    <i class="bi bi-share"></i>
                </button>
                <button id="infoBtn" class="info-btn" title="View Image Info">
                    <i class="bi bi-info-circle"></i>
                </button>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    
    <!-- Image Info Modal -->
    <div class="modal fade" id="imageInfoModal" tabindex="-1" aria-labelledby="imageInfoModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="imageInfoModalLabel">Image Information</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <div id="imageInfoContent">
                        <!-- Image info will be populated here -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- SVG Filter Definitions -->
    <svg style="display:none;">
        <defs>
            <!-- Blur effect -->
            <filter id="svg-blur">
                <feGaussianBlur id="blur-filter" in="SourceGraphic" stdDeviation="3" />
            </filter>
            
            <!-- Sharpen effect -->
            <filter id="svg-sharpen">
                <feConvolveMatrix in="SourceGraphic"
                    kernelMatrix="0 -2 0 -2 11 -2 0 -2 0"
                    divisor="3" />
            </filter>
            
            <!-- Sepia tone effect -->
            <filter id="svg-sepia">
                <feColorMatrix type="saturate" values="0.5" />
                <feColorMatrix type="matrix" values=".393 .769 .189 0 0
                                                      .349 .686 .168 0 0
                                                      .272 .534 .131 0 0
                                                      0 0 0 1 0" />
            </filter>
            
            <!-- High contrast effect -->
            <filter id="svg-highcontrast">
                <feComponentTransfer>
                    <feFuncR type="discrete" tableValues="0 1"/>
                    <feFuncG type="discrete" tableValues="0 1"/>
                    <feFuncB type="discrete" tableValues="0 1"/>
                </feComponentTransfer>
                <feColorMatrix type="saturate" values="2" />
            </filter>
            
            <!-- Vintage effect -->
            <filter id="svg-vintage">
                <feColorMatrix type="saturate" values="0.6" />
                <feComponentTransfer>
                    <feFuncR type="linear" slope="0.8" intercept="0.1"/>
                    <feFuncG type="linear" slope="0.8" intercept="0.08"/>
                    <feFuncB type="linear" slope="0.6" intercept="0.05"/>
                </feComponentTransfer>
            </filter>
            
            <!-- Posterize effect -->
            <filter id="svg-posterize">
                <feComponentTransfer>
                    <feFuncR type="discrete" tableValues="0 0.25 0.5 0.75 1"/>
                    <feFuncG type="discrete" tableValues="0 0.25 0.5 0.75 1"/>
                    <feFuncB type="discrete" tableValues="0 0.25 0.5 0.75 1"/>
                </feComponentTransfer>
            </filter>
            
            <!-- Emboss effect -->
            <filter id="svg-emboss">
                <feConvolveMatrix in="SourceGraphic"
                    kernelMatrix="-2 -1 0 -1 1 1 0 1 2"
                    divisor="1"
                    bias="0.5" />
            </filter>
            
            <!-- Glitch/Displacement effect -->
            <filter id="svg-glitch">
                <feTurbulence type="fractalNoise" baseFrequency="0.05" numOctaves="2" result="noise" seed="2"/>
                <feDisplacementMap in="SourceGraphic" in2="noise" scale="3" xChannelSelector="R" yChannelSelector="G"/>
            </filter>
            
            <!-- Invert effect -->
            <filter id="svg-invert">
                <feComponentTransfer>
                    <feFuncR type="linear" slope="-1" intercept="1"/>
                    <feFuncG type="linear" slope="-1" intercept="1"/>
                    <feFuncB type="linear" slope="-1" intercept="1"/>
                </feComponentTransfer>
            </filter>
        </defs>
    </svg>
    
    <script src="images.js"></script>
    <script src="app.js"></script>
</body>
</html>
